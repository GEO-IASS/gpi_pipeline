
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Calibration Database &mdash; GPI Data Pipeline 1.3.0 documentation</title>
    
    <link rel="stylesheet" href="../_static/sphinxdoc_gpi.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '1.3.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
    <link rel="top" title="GPI Data Pipeline 1.3.0 documentation" href="../index.html" />
    <link rel="up" title="GPI Data Pipeline Developer’s Guide" href="index.html" />
    <link rel="next" title="Utility Functions" href="utilities.html" />
    <link rel="prev" title="Pipeline Code Internal Organization" href="organization.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="utilities.html" title="Utility Functions"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="organization.html" title="Pipeline Code Internal Organization"
             accesskey="P">previous</a> |</li>
        <li><a href="../index.html">GPI Data Pipeline 1.3.0 documentation</a> &raquo;</li>
          <li><a href="index.html" accesskey="U">GPI Data Pipeline Developer&#8217;s Guide</a> &raquo;</li> 
      </ul>
    </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../index.html">
              <img class="logo" src="../_static/GPI_Logo_v2012.png" alt="Logo"/>
            </a></p>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
  <h3><a href="../index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Calibration Database</a><ul>
<li><a class="reference internal" href="#rules-for-matching-files">Rules for Matching Files</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="organization.html"
                        title="previous chapter">Pipeline Code Internal Organization</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="utilities.html"
                        title="next chapter">Utility Functions</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="../_sources/developers/caldb.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="calibration-database">
<h1>Calibration Database<a class="headerlink" href="#calibration-database" title="Permalink to this headline">¶</a></h1>
<div class="section" id="rules-for-matching-files">
<span id="caldb-devel"></span><h2>Rules for Matching Files<a class="headerlink" href="#rules-for-matching-files" title="Permalink to this headline">¶</a></h2>
<p>When you request a calibration file, the first step is to select all
calibration files of a given type (for instance, all darks, or all wavelength
calibrations). Once it has that list, it has to restrict to a subset of
applicable calibration files. This happens based on FITS keywords, as follows:</p>
<ul class="simple">
<li>Darks match on ITIME and IFS Readoutmode</li>
<li>Wavecals, flats, polcals, instrumental polarizations, telluric transmissions all match on IFSFILT and DISPERSR</li>
<li>Spot location and grid ratio match on Filter only.</li>
<li>Bad pixel maps, pixel scale, distortion measurements all match only on calibration type.</li>
</ul>
<p>That selection yields a set of calibration files of the appropriate type (for
instance, all H-band spectral wavelength calibrations).</p>
<p>Because the instrument configuration or detector properties can change
significantly whenever you warm up the IFS, by default we then restrict our
consideration to only calibration files taken from the same cooldown run as the
science data. That is, any calibration files from before the start of that
cooldown or after the start of the next cooldown will not be considered. The
list of cooldowns is maintained in a file in the pipeline configuration
directory.</p>
<p>Then from the subset of available files, you have to select the best one. The logic for that is as follows:</p>
<ol class="arabic simple">
<li>Find the closest-in-time calibration to the science data. Once you know the filename and date of that calibration file, check to see if there are any other calibration files in the selected subset with times within ±12 hours of that closest file.<ol class="loweralpha">
<li>If there is only one such file, return it as the best calibration.</li>
<li>If there are several such files, proceed to step 2.</li>
</ol>
</li>
<li>From all the selected files within that date range, find the one that has the maximum integration time.<ol class="loweralpha">
<li>If there is only one such file, return it as the best calibraiton</li>
<li>If there are several files with identical exposure times, proceed to step 3.</li>
</ol>
</li>
<li>From all the selected files in that date range with the max exposure time, return the single file which is closest in time.</li>
</ol>
<p>This is kind of convoluted but in practice should do a fairly robust job of
automatically identifying the most appropriate calibration file in almost all
circumstances. And remember, users can always manually select calibration files
as well.</p>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="utilities.html" title="Utility Functions"
             >next</a> |</li>
        <li class="right" >
          <a href="organization.html" title="Pipeline Code Internal Organization"
             >previous</a> |</li>
        <li><a href="../index.html">GPI Data Pipeline 1.3.0 documentation</a> &raquo;</li>
          <li><a href="index.html" >GPI Data Pipeline Developer&#8217;s Guide</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2008-2014, Marshall Perrin, Jerome Maire &amp; the GPI Data Analysis Team.
      Last updated on Jun 18, 2015.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.2.2.
    </div>
  </body>
</html>