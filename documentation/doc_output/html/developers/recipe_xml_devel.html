
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Appendix: Recipe XML File (‘DRF’) Format &mdash; GPI Data Pipeline 1.3.0 documentation</title>
    
    <link rel="stylesheet" href="../_static/sphinxdoc_gpi.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '1.3.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
    <link rel="top" title="GPI Data Pipeline 1.3.0 documentation" href="../index.html" />
    <link rel="up" title="GPI Data Pipeline Developer’s Guide" href="index.html" />
    <link rel="next" title="Appendix: Primitives Configuration XML File Format and Generation" href="primitives_config_xml_devel.html" />
    <link rel="prev" title="Release Guide: Versions, Version Tracking, etc" href="releases_and_versioning.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="primitives_config_xml_devel.html" title="Appendix: Primitives Configuration XML File Format and Generation"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="releases_and_versioning.html" title="Release Guide: Versions, Version Tracking, etc"
             accesskey="P">previous</a> |</li>
        <li><a href="../index.html">GPI Data Pipeline 1.3.0 documentation</a> &raquo;</li>
          <li><a href="index.html" accesskey="U">GPI Data Pipeline Developer&#8217;s Guide</a> &raquo;</li> 
      </ul>
    </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../index.html">
              <img class="logo" src="../_static/GPI_Logo_v2012.png" alt="Logo"/>
            </a></p>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
  <h3><a href="../index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Appendix: Recipe XML File (&#8216;DRF&#8217;) Format</a><ul>
<li><a class="reference internal" href="#recipe-drf-xml-tags">Recipe DRF XML tags</a></li>
<li><a class="reference internal" href="#common-parameters">Common parameters</a></li>
<li><a class="reference internal" href="#example-drf">Example DRF</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="releases_and_versioning.html"
                        title="previous chapter">Release Guide: Versions, Version Tracking, etc</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="primitives_config_xml_devel.html"
                        title="next chapter">Appendix: Primitives Configuration XML File Format and Generation</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="../_sources/developers/recipe_xml_devel.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="appendix-recipe-xml-file-drf-format">
<h1>Appendix: Recipe XML File (&#8216;DRF&#8217;) Format<a class="headerlink" href="#appendix-recipe-xml-file-drf-format" title="Permalink to this headline">¶</a></h1>
<p>In normal usage, Recipe XML files are typically created using the GUI, but they
may be edited by hand. We describe here the file format, called a &#8220;Data Reduction File (DRF)&#8221; in terminology adapted from the Keck OSIRIS pipeline.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The DRF file format is extremely similar to and descended from, but <strong>not</strong> exactly identical to,
the format of Keck OSIRIS DRFs.  The following explanatory text is derived and adapted from
from the OSIRIS manual by Larkin et al., with modifications for GPI.</p>
</div>
<p>In general, an XML document is a simple ASCII file composed of markup tags. For GPI Recipe files,
the most common tag is used to specify the operation of a particular primitive such as:</p>
<div class="highlight-python"><div class="highlight"><pre>&lt;primitive Name=&quot;Load Wavelength Calibration&quot; CalibrationFile=&#39;AUTOMATIC&#39; Skip=&quot;0&quot;/&gt;
</pre></div>
</div>
<p>In this example, the tag is enclosed in a <cite>&lt;</cite> and <cite>/&gt;</cite> to indicate the start and
end of the tag. Alternatively, we could have used a <cite>&lt;</cite> and a <cite>&gt;</cite> around the tag
contents, but then the complete tag would require an additional &lt;/primitive&gt; to
specify the end of the tag. This would look like:</p>
<div class="highlight-python"><div class="highlight"><pre>&lt;primitive Name=&quot;Load Wavelength Calibration&quot; CalibrationFile=&#39;AUTOMATIC&#39; Skip=&quot;0&quot;&gt; &lt;/module&gt;
</pre></div>
</div>
<p>The module is the element start tag and specifies the type of tag, in this case
a module (primitive) call. Then Name , CalibrationFile, and Skip specify &#8216;attributes&#8217; of the tag. It is up to
the pipeline to interpret these attributes. In many cases, tags can be nested,
and in fact a DRF is really just one <cite>&lt;DRF&gt;</cite> tag with many sub-tags. Generally
white space such as spaces and carriage returns are ignored.</p>
<p>To add a comment to an xml file surround the text in a <cite>&lt;!&#8211;</cite> and a <cite>&#8211;&gt;</cite> such as in this example:</p>
<div class="highlight-python"><div class="highlight"><pre>&lt;!--This is a comment --&gt;
</pre></div>
</div>
<div class="section" id="recipe-drf-xml-tags">
<h2>Recipe DRF XML tags<a class="headerlink" href="#recipe-drf-xml-tags" title="Permalink to this headline">¶</a></h2>
<dl class="docutils">
<dt>Now we&#8221;ll begin looking at DRF specific XML tags. All DRFs must start with a header specifying the flavor of xml to use::</dt>
<dd>&lt;?xml version=&#8221;1.0&#8221; encoding=&#8221;UTF-8&#8221;?&gt;</dd>
</dl>
<p>This is then followed by a DRF tag which can include
a Name attribe and/or a ReductionType attribute.  Name provides a descriptive name for use in the Data Parser and Recipe Editor GUIs, but does not have any quantitiative effect on the data processing. Similarly, ReductionType provides a way to divide recipes into different sets for convenience, but does not directly impact the data processing.</p>
<dl class="docutils">
<dt>So an example DRF tag might look like::</dt>
<dd>&lt;DRF ReductionType=&#8221;regular&#8217;&gt;</dd>
</dl>
<p>Note that the <cite>&gt;</cite> does not end the tag and future tags are really attributes within the DRF tag. At the end of the file, you must close the DRF tag with a <cite>&lt;/DRF&gt;</cite>. See below for examples.</p>
<p>After the DRF tag, you need to define the data frames that should be processed. This is done with the DATASET tag. It must include series of FITS elements that list the filenames. It <em>may</em> include an InputDir attribute, in which case this string will be added before each of the individual filenames. As of GPI DRP 0.9.3, if you wish to include files from multiple directories, this is supported: just enter the full filenames for each and leave the InputDir tag missing or blank.
Optionally you can outputdir attribute. So
An example of the DATASET tag might be:</p>
<div class="highlight-python"><div class="highlight"><pre>&lt;dataset InputDir=&quot;/mnt/gpi/Detector/130717/&quot; &gt;
    &lt;fits FileName=&quot;S20130717S0001.fits&quot; /&gt;
    &lt;fits FileName=&quot;S20130717S0002.fits&quot; /&gt;
    &lt;fits FileName=&quot;S20130717S0003.fits&quot; /&gt;
    &lt;fits FileName=&quot;S20130717S0004.fits&quot; /&gt;
&lt;/dataset&gt;
</pre></div>
</div>
<p>The typical DRF is then composed of a series of items specifying the order of the reduction steps as well as any calibration files and parameters that are needed. The name of the module must be specified using the Name attribute. These names are not negotiable and the exact name must be used. Examples:</p>
<div class="highlight-python"><div class="highlight"><pre>&lt;primitive name=&quot;Extract Spectral Datacube&quot; Save=&quot;0&quot; /&gt;?
&lt;primitive name=&quot;Simple SSDI&quot; L1Min=&quot;1.55&quot; L1Max=&quot;1.57&quot; L2Min=&quot;1.60&quot; L2Max=&quot;1.65&quot; k=&quot;1.0&quot; Save=&quot;1&quot; gpitv=&quot;5&quot; /&gt;
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The XML element &#8220;module&#8221; is taken to be synonymous with &#8220;primitive&#8221;, for back compatibility reasons. There is no difference between these two names in terms of pipeline functionality. The terms will be used interchangeably in the following.</p>
</div>
<p>Datasets can also have an associated OutputDir attribute. This can be used to specific a particular directory into which data will be written.
Optionally instead this can be the string &#8216;AUTOMATIC&#8217;, in which case the output directory will be chosen automatically as a
YYMMDD-labeled subdirectory of the $GPI_REDUCED_DATA_DIR.</p>
</div>
<div class="section" id="common-parameters">
<h2>Common parameters<a class="headerlink" href="#common-parameters" title="Permalink to this headline">¶</a></h2>
<p>Each primitive can have an arbitrary list of parameters, just like keywords in IDL. However, due to the required way the XML file is parsed, all attributes must be strings enclosed in quotes. This is true even for simple integer values.</p>
<p>If the step needs a calibration file (i.e., Subtract Dark Frame, Extract Spectra) the attribute will look like:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">CalibrationFile</span><span class="o">=</span><span class="s">&#39;/directory/SPEC/calib/calibration_file.fits&#39;</span>
</pre></div>
</div>
<p>If you decide to re-run a DRF and would like to skip a particular module, the easiest way is with the Skip attribute. Set it to Ô1&#8221; in order to skip the file, and set it back to Ô0&#8221; to execute the file. The default is Ô0&#8221; and is not required.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">Skip</span><span class="o">=</span><span class="s">&quot;1&quot;</span>
</pre></div>
</div>
<p>Many modules allow the output data to be piped to a GPItv window for immediate display. Just set the gpitv argument equal to the session number of the window to display in.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">gpitv</span><span class="o">=</span><span class="s">&quot;3&quot;</span>
</pre></div>
</div>
<p>Others allow the user to save the results of this step (distinct from saving the final output at the end of the whole list of steps)</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">save</span><span class="o">=</span><span class="s">&quot;1&quot;</span>
</pre></div>
</div>
<p>Other attributes are specific to each module or used by a subset of modules and are described elsewhere.</p>
</div>
<div class="section" id="example-drf">
<h2>Example DRF<a class="headerlink" href="#example-drf" title="Permalink to this headline">¶</a></h2>
<div class="highlight-python"><div class="highlight"><pre>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;DRF LogPath=&quot;/Users/mperrin/projects/GPI/pipnew/drp_code&quot; ReductionType=&quot;Final&quot;&gt;
&lt;dataset InputDir=&quot;/Users/mperrin/projects/GPI/data&quot; OutputDir=&quot;/Users/mperrin/projects/GPI/pipnew/drp_code&quot;&gt;
 &lt;fits FileName=&quot;Ima10_H.fits&quot; /&gt;
 &lt;fits FileName=&quot;Ima11_H.fits&quot; /&gt;
 &lt;fits FileName=&quot;Ima12_H.fits&quot; /&gt;
 &lt;fits FileName=&quot;Ima13_H.fits&quot; /&gt;
 &lt;fits FileName=&quot;Ima14_H.fits&quot; /&gt;
 &lt;fits FileName=&quot;Ima15_H.fits&quot; /&gt;
 &lt;fits FileName=&quot;Ima16_H.fits&quot; /&gt;
 &lt;fits FileName=&quot;Ima17_H.fits&quot; /&gt;
 &lt;fits FileName=&quot;Ima18_H.fits&quot; /&gt;
&lt;/dataset&gt;
&lt;primitive name=&quot;Read Wavelength Calibration&quot; CalibrationFile=&quot;/Users/mperrin/GPI/pipnew/drp_code/Ima2_HH-wavcal-comb.fits&quot; /&gt;
&lt;primitive name=&quot;Display Data with GPITV&quot; gpitv=&quot;1&quot; /&gt;
&lt;primitive name=&quot;Extract Spectral Datacube&quot; Save=&quot;0&quot; /&gt;
&lt;primitive name=&quot;Divide spectral data by flat&quot; CalibrationFile=&quot;/Users/mperrin/projects/GPI/pipnew/drp_code/Ima4_Hflat.fits&quot; Save=&quot;1&quot; gpitv=&quot;2&quot; /&gt;
&lt;primitive name=&quot;Interpolate Wavelength Axis&quot; Save=&quot;1&quot; gpitv=&quot;2&quot; /&gt;
&lt;primitive name=&quot;Simple SSDI&quot; L1Min=&quot;1.55&quot; L1Max=&quot;1.57&quot; L2Min=&quot;1.60&quot; L2Max=&quot;1.65&quot; k=&quot;1.0&quot; Save=&quot;1&quot; gpitv=&quot;5&quot; /&gt;
&lt;primitive name=&quot;Accumulate Images&quot; Method=&quot;OnDisk&quot; /&gt;
&lt;primitive name=&quot;ADI based on Marois et al&quot; numimmed=&quot;3&quot; nfwhm=&quot;1.5&quot; Save=&quot;0&quot; gpitv=&quot;10&quot; /&gt;
&lt;primitive name=&quot;Median ADI data-cubes&quot; Save=&quot;1&quot; gpitv=&quot;10&quot; /&gt;
&lt;/DRF&gt;
</pre></div>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="primitives_config_xml_devel.html" title="Appendix: Primitives Configuration XML File Format and Generation"
             >next</a> |</li>
        <li class="right" >
          <a href="releases_and_versioning.html" title="Release Guide: Versions, Version Tracking, etc"
             >previous</a> |</li>
        <li><a href="../index.html">GPI Data Pipeline 1.3.0 documentation</a> &raquo;</li>
          <li><a href="index.html" >GPI Data Pipeline Developer&#8217;s Guide</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2008-2014, Marshall Perrin, Jerome Maire &amp; the GPI Data Analysis Team.
      Last updated on Jun 18, 2015.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.2.2.
    </div>
  </body>
</html>