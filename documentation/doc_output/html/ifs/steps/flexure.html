
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>IFS Flexure &mdash; GPI Data Pipeline 1.3.0 documentation</title>
    
    <link rel="stylesheet" href="../../_static/sphinxdoc_gpi.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '1.3.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
    <link rel="top" title="GPI Data Pipeline 1.3.0 documentation" href="../../index.html" />
    <link rel="up" title="Processing GPI Data, Step by Step" href="index.html" />
    <link rel="next" title="Datacube Extraction" href="datacube_extraction.html" />
    <link rel="prev" title="Wavelength Calibration" href="wavelength_calibration.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="datacube_extraction.html" title="Datacube Extraction"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="wavelength_calibration.html" title="Wavelength Calibration"
             accesskey="P">previous</a> |</li>
        <li><a href="../../index.html">GPI Data Pipeline 1.3.0 documentation</a> &raquo;</li>
          <li><a href="../index.html" >GPI IFS Data Handbook</a> &raquo;</li>
          <li><a href="index.html" accesskey="U">Processing GPI Data, Step by Step</a> &raquo;</li> 
      </ul>
    </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../../index.html">
              <img class="logo" src="../../_static/GPI_Logo_v2012.png" alt="Logo"/>
            </a></p>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
  <h3><a href="../../index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">IFS Flexure</a><ul>
<li><a class="reference internal" href="#observed-effect-and-relevant-physics">Observed Effect and Relevant Physics:</a></li>
<li><a class="reference internal" href="#using-flexure-shifts-in-the-gpi-pipeline">Using Flexure Shifts in the GPI Pipeline</a></li>
<li><a class="reference internal" href="#things-to-watch-out-for">Things to watch out for:</a></li>
<li><a class="reference internal" href="#relevant-gpi-team-members">Relevant GPI team members</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="wavelength_calibration.html"
                        title="previous chapter">Wavelength Calibration</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="datacube_extraction.html"
                        title="next chapter">Datacube Extraction</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="../../_sources/ifs/steps/flexure.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="ifs-flexure">
<span id="id1"></span><h1>IFS Flexure<a class="headerlink" href="#ifs-flexure" title="Permalink to this headline">¶</a></h1>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last">Further information may be found in <a class="reference external" href="http://arxiv.org/abs/1407.2304">Wolff et al. 2014 &#8220;Gemini Planet Imager Observational Calibrations IV: Wavelength Calibration and Flexure Correction for the Integral Field Spectrograph&#8221;</a> and also in
<a class="reference external" href="http://arxiv.org/abs/1407.2303">Ingraham et al. 2014 &#8220;Gemini Planet Imager Observational Calibrations III: Empirical Measurement Methods and Applications of High-Resolution Microlens PSFs&#8221;</a></p>
</div>
<div class="section" id="observed-effect-and-relevant-physics">
<h2>Observed Effect and Relevant Physics:<a class="headerlink" href="#observed-effect-and-relevant-physics" title="Permalink to this headline">¶</a></h2>
<p>The positions of the individual spectra formed from each microlens are subject to gravitationally induced flexure that affects optical components between the microlens array and science detector on the IFS optical bench. Under normal observational procedure, as the instrument moves in elevation, the flexure is observed to follow standard hysteresis curves with amplitudes of ~0.5 pixels.</p>
<p>When the instrument is moved outside of it&#8217;s normal observing range, being above ~80 degrees in elevation or when the cassegrain rotator is in use due to ongoing observations with other instruments, a non-repeatable and unpredictable flexure component is introduced. Although the cause of this has not been confirmed, it is believed to result from an optic or it&#8217;s mount in the IFS exhibiting micron-level shifts when moved into non-standard positions. Due to the sensitive IFS alignment and the inaccessibility of the suspected optic, it has been decided to compensate for the non-repeatable flexure component in the data reduction software.</p>
<p>Currently, the data reduction pipeline (DRP) corrects for the repeatable component of flexure by adding offsets to the positions of the microspectra that were determined when measuring their wavelength solution (zenith). This is accomplished using a lookup table and the <a class="reference internal" href="../../usage/primitives.html#updatespotshiftsforflexure"><em>Update Spot Shifts for Flexure</em></a> primitive. In  order to compensate for the non-repeatable component of the flexure, an arclamp image (normally Argon) is taken at either the beginning or end of the observing sequence. This provides a zero point offset to the hysteresis curves. How to implement this offset is discussed below.</p>
<p>It is worth noting here that the IFS flexure also impedes our ability to preform a flat field correction because the spectra fall on different pixels throughout the observation, more details can be found in the <a class="reference internal" href="flat_fielding_lenslets.html#processing-step-by-step-flat-fielding-lenslets"><em>Lenslet flat field</em></a> and <a class="reference internal" href="flat_fielding_detector.html#processing-step-by-step-flat-fielding-detector"><em>Detector flat fielding</em></a> sections.</p>
</div>
<div class="section" id="using-flexure-shifts-in-the-gpi-pipeline">
<h2>Using Flexure Shifts in the GPI Pipeline<a class="headerlink" href="#using-flexure-shifts-in-the-gpi-pipeline" title="Permalink to this headline">¶</a></h2>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The <a class="reference internal" href="../../usage/tutorial.html#usage-quickstart"><em>quick start tutorial</em></a> gives a quick example on how to apply flexure offets to wavelength calibrations, we recommend at least reading the applicable sections of the tutorial prior to this section.</p>
</div>
<p>When reducing science data, the standard recipes, <a class="reference internal" href="../../usage/templates.html#spectralscience-templates"><em>Spectral Science</em></a> contain the <a class="reference internal" href="../../usage/primitives.html#updatespotshiftsforflexure"><em>Update spot shifts for flexure</em></a> primitive. This primitive allows the user to select between a manual flexure shift, default flexure shifts from a lookup table, no shifts, and the BandShift mode. If manual flexure shifts are chosen, the x and y shifts are controlled by the <tt class="docutils literal"><span class="pre">manual_dx</span></tt> and <tt class="docutils literal"><span class="pre">manual_dy</span></tt> keywords. The Lookup method requires a calibration file with a &#8216;shifts&#8217; extension. This table lists the shifts in x and y as a function of elevation.  This method will compensate for the repeatable flexure offsets discussed above. The BandPass mode was developed to take advantage of the derived shifts from the quick H band arc lamp images taken at the same elevation as science targets across all bands. It uses the x and y positions from the most recent wavelength calibration and extrapolates to the bandpass of the science data. This mode is not extensively tested.  We recommend beginning with the lookup table option.</p>
<p>If your datacube was reduced with the wrong flexure solution, the datacube will exhibit a checkerboard pattern. The figure below shows a slice of a datacube that used incorrect flexure shifts (1.5 pixels off in both x and y).</p>
<div class="figure align-center">
<a class="reference internal image-reference" href="../../_images/bad_flexure.png"><img alt="../../_images/bad_flexure.png" src="../../_images/bad_flexure.png" style="width: 400pt;" /></a>
</div>
<p>In this case, it is likely necessary to input a manual flexure since a non-repeatable flexure component has resulted in an offset to the standard flexure curves. To determine the necessary shifts, you should open the raw science frame and overplot the wavelength solution. For information on how to do this see <a class="reference internal" href="../../gpitv/features.html#gpitv-wavecal-grid"><em>Displaying GPI Wavelength Calibration feature</em></a>. The user may change the position of the overplotted lenslet locations until they line up with the data. Sub pixel position accuracy is possible by eye. Once the wavelength solution is plotted over the Raw data, the user can click and drag the wavelength solution grid using the &#8216;Move Wavecal Grid&#8217; Mouse Mode. The offsets will be displayed in red to the nearest pixel.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The x direction shifts are easy to determine by eye, but the ability to determine the shifts in the y-direction can be dependent on the spectral features of your target.</p>
</div>
<p>It has become stardard practice at Gemini South to take short exposure arc lamp images contemporary with all GPI science targets for flexure compensation. The user should then run the <em>Quick Wavelength Solution</em> recipe template (found under the Calibration recipe menu), on the Argon lamp image taken with the data. The user should input the approximate solutions (rounded to the nearest integer) into the <tt class="docutils literal"><span class="pre">xoffset</span></tt> and <tt class="docutils literal"><span class="pre">yoffset</span></tt> parameters into the <a class="reference internal" href="../../usage/primitives.html#quickwavelengthsolutionupdate"><em>Quick Wavelength Solution Update</em></a> primitive. When running the recipe, one must be careful to ensure the proper wavelength calibration is grabbed from the database (check the output in the pipeline xterm). If the wrong one is selected, then you can manually choose the correct one using the Choose Calibration File button. By default, a new wavelength calibration corresponding to the wavelength of the Argon arc taken with the data is created. Printed on the pipeline xterm window will also be the calculated offsets and uncertainties from the master wavelength calibration.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The offsets calculated will apply to <strong>ALL</strong> master wavelength calibrations since they are all taken with the telescope at zenith.</p>
</div>
<p>The user should verify that these offsets make sense relative to the offsets they determined by eye. It is also recommended that the user examine the solution, this can be done by setting the <tt class="docutils literal"><span class="pre">display</span></tt> parameter to a value greater than 1. The user can sometimes increase the precision by decreasing the <tt class="docutils literal"><span class="pre">spacing</span></tt> parameter at the cost of computing time. Expanding the <tt class="docutils literal"><span class="pre">boxsizex</span></tt> or <tt class="docutils literal"><span class="pre">boxsizey</span></tt> parameter may also help in finding the proper solution.</p>
</div>
<div class="section" id="things-to-watch-out-for">
<h2>Things to watch out for:<a class="headerlink" href="#things-to-watch-out-for" title="Permalink to this headline">¶</a></h2>
<p>The <a class="reference internal" href="../../usage/primitives.html#quickwavelengthsolutionupdate"><em>Quick Wavelength Solution Update</em></a> will output offsets regardless of their validity. It is very important the user checks them!</p>
<p>If the user reduces their data using the wavelength solution created using a Quick Wavelength solution, the flexure offsets as the target moves in elevation will be applied if the Lookup method is enabled. For short observations, the amount of elevation change will be very small and no flexure compensation will be required.</p>
</div>
<div class="section" id="relevant-gpi-team-members">
<h2>Relevant GPI team members<a class="headerlink" href="#relevant-gpi-team-members" title="Permalink to this headline">¶</a></h2>
<p>Patrick Ingraham, Marshall Perrin, Schuyler Wolff</p>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="datacube_extraction.html" title="Datacube Extraction"
             >next</a> |</li>
        <li class="right" >
          <a href="wavelength_calibration.html" title="Wavelength Calibration"
             >previous</a> |</li>
        <li><a href="../../index.html">GPI Data Pipeline 1.3.0 documentation</a> &raquo;</li>
          <li><a href="../index.html" >GPI IFS Data Handbook</a> &raquo;</li>
          <li><a href="index.html" >Processing GPI Data, Step by Step</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2008-2014, Marshall Perrin, Jerome Maire &amp; the GPI Data Analysis Team.
      Last updated on Jun 18, 2015.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.2.2.
    </div>
  </body>
</html>