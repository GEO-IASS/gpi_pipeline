
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Flat Fielding &mdash; GPI Data Pipeline 1.3.0 documentation</title>
    
    <link rel="stylesheet" href="../../_static/sphinxdoc_gpi.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '1.3.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
    <link rel="top" title="GPI Data Pipeline 1.3.0 documentation" href="../../index.html" />
    <link rel="up" title="Processing GPI Data, Step by Step" href="index.html" />
    <link rel="next" title="Flat Fielding: Lenslet Array Flat" href="flat_fielding_lenslets.html" />
    <link rel="prev" title="Persistence" href="persistence.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="flat_fielding_lenslets.html" title="Flat Fielding: Lenslet Array Flat"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="persistence.html" title="Persistence"
             accesskey="P">previous</a> |</li>
        <li><a href="../../index.html">GPI Data Pipeline 1.3.0 documentation</a> &raquo;</li>
          <li><a href="../index.html" >GPI IFS Data Handbook</a> &raquo;</li>
          <li><a href="index.html" accesskey="U">Processing GPI Data, Step by Step</a> &raquo;</li> 
      </ul>
    </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../../index.html">
              <img class="logo" src="../../_static/GPI_Logo_v2012.png" alt="Logo"/>
            </a></p>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
  <h3><a href="../../index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Flat Fielding</a><ul>
<li><a class="reference internal" href="#observed-effect-and-relevant-physics">Observed Effect and Relevant Physics:</a></li>
<li><a class="reference internal" href="#using-flats-in-gpi-pipeline-reduction">Using Flats in GPI Pipeline Reduction:</a></li>
<li><a class="reference internal" href="#creating-calibrations">Creating Calibrations:</a><ul>
<li><a class="reference internal" href="#what-to-watch-out-for">What to Watch Out For</a></li>
</ul>
</li>
<li><a class="reference internal" href="#relevant-gpi-team-members">Relevant GPI team members</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="persistence.html"
                        title="previous chapter">Persistence</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="flat_fielding_lenslets.html"
                        title="next chapter">Flat Fielding: Lenslet Array Flat</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="../../_sources/ifs/steps/flat_fielding_detector.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="flat-fielding">
<span id="processing-step-by-step-flat-fielding-detector"></span><h1>Flat Fielding<a class="headerlink" href="#flat-fielding" title="Permalink to this headline">¶</a></h1>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">This is one of the areas where algorithms are still in flux and calibration methods are not fully mature.</p>
</div>
<div class="section" id="observed-effect-and-relevant-physics">
<h2>Observed Effect and Relevant Physics:<a class="headerlink" href="#observed-effect-and-relevant-physics" title="Permalink to this headline">¶</a></h2>
<p>The goal of a flat-field is to correct for transmission of the instrument as a function of field-of-view. This includes multiple contibuting effects including:</p>
<blockquote>
<div><ol class="arabic simple">
<li>Quantum efficiency variations of the Detector (includes: intrapixel sensitivity variations, pixel-to-pixel variations and low-frequency variations).</li>
<li>Field dependent instrument transmission (includes such effects vignetting (not present in GPI), optical element transmission variations etc.)</li>
</ol>
</div></blockquote>
<p>Whereas traditional imagers/spectrographs illuminate the entire detector (or portion of interest) in order to determine the majority of the above effects simultaneously, the permanently installed lenslet array in GPI, prohibits a uniform illumination.</p>
<p>Until recently, the flat-fielding has been performed by flood illuminating the instrument using an integration sphere inserted into the telescope simulator. The data was then reduced into a data-cube and the median lamp spectrum removed. Assuming the illumination to be uniform, this provides a calibration of the instrument sensitivity as a function of field of view (including the transmission properties of the lenslet array), and a calibration for the excluded flux when using the 3-pixel box extraction algorithm (see <a class="reference internal" href="datacube_extraction.html"><em>Datacube Extraction</em></a> for details). This algorithm also accounts for the pixel-to-pixel variations, so long as the spectra in the science image rests exactly at the same position as the spectra from the flat lamp. For this scenario, the flat-fielding is done in datacube space, rather than detector space (the tradiation method).</p>
<p>The fundamental problem with this scenario is its failure to account for the effect of flexure. As the instrument flexs, the spectra are moved onto different pixels that are not illuminated by the flat field. This causes multiple problems.</p>
<blockquote>
<div><ol class="arabic simple">
<li>As there is no illumination of the adjacent pixels in the flat field, no pixel-to-pixel sensitivity information is known</li>
<li>The three-box extraction algoritm will sample a different quantity of flux and therefore apply the incorrect correction</li>
<li>The measured amount of detected flux contained in the PSF changes due to the intrapixel sensitivity.</li>
</ol>
</div></blockquote>
<p>Seeing as it is unrealistic to perform a flat-field at every single instrument position, a new flat-fielding technique is required. Because no single flat-field image is able to accomplish all of the necessary corrections, a two-step approach will be used. In the first step, a low-frequency/lenslet-to-lenslet variation is determined by examining the total flux difference each lenslet. In the second step, the lenslet PSF is used to divide by the lamp spectrum in order to reveal the pixel to pixel variations. Because the flexure moves the PSF to various pixels, flat-fields will have to be taken at multiple (at least two) telescope/instrument positions. The implementation of this technique in the pipeline is currently underway and will be completed prior to first light.</p>
</div>
<div class="section" id="using-flats-in-gpi-pipeline-reduction">
<h2>Using Flats in GPI Pipeline Reduction:<a class="headerlink" href="#using-flats-in-gpi-pipeline-reduction" title="Permalink to this headline">¶</a></h2>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last"><strong>The division of a flat field is not currently being performed due to the issues described in the above section.</strong></p>
</div>
<p>Upon the development of new algoritms, the low-order and high-order flat field corrections should be applied to all science images. Because the flat-field data will be taken at the same time as the science observations, no flat field correction is applied when using the autoreducer. When performing the science-grade reduction of the observation, often performed using the &#8216;Calibrated Datacube Extraction&#8217; recipe, a low and high frequency flat field correction will be applied. Typically, these flat-fields will be obtained automatically from the <a class="reference internal" href="../../usage/calibdb.html#calibdb"><em>Calibration Database</em></a> based on the closest-in-time flat correction. There are no significant user-selectable options for this step to be concerned with.</p>
</div>
<div class="section" id="creating-calibrations">
<h2>Creating Calibrations:<a class="headerlink" href="#creating-calibrations" title="Permalink to this headline">¶</a></h2>
<p><strong>Calibration DB File Type:</strong> Flat Field</p>
<p><strong>File Suffix:</strong> flat</p>
<p><strong>Generate with Recipe:</strong> &#8216;Flat-field Extraction&#8217; (spectral mode), &#8216;Create Polarized Flat-field&#8217; (polarimetry mode)</p>
<p>To produce the currently available flat fields that can only be used with flats obtained at the same flexure position, take a set of flat field observations in desired mode and filter. Reduce with the appropriate recipe.</p>
<div class="section" id="what-to-watch-out-for">
<h3>What to Watch Out For<a class="headerlink" href="#what-to-watch-out-for" title="Permalink to this headline">¶</a></h3>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This section will be completed upon implementation of the new flat-fielding alogorithm</p>
</div>
<p>Similar to dark frames, flat field frames will also exhibit striping and microphonics, but because there is structure throughout the entire image, the standard destriping algorithms (<a class="reference internal" href="../../usage/primitives.html#destripefordarksonly"><em>Destripe for Darks Only</em></a>) cannot be applied (see section <a class="reference internal" href="destriping_and_microphonics.html"><em>Destriping and Microphonics</em></a> for details). The consequence of this is that the detector noise in flat-fields will be significantly higher than science frames. However, because of the large signal-to-noise in the images, the detector induced noise is expected to be negligible.</p>
</div>
</div>
<div class="section" id="relevant-gpi-team-members">
<h2>Relevant GPI team members<a class="headerlink" href="#relevant-gpi-team-members" title="Permalink to this headline">¶</a></h2>
<p>Patrick Ingraham, Marshall Perrin</p>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="flat_fielding_lenslets.html" title="Flat Fielding: Lenslet Array Flat"
             >next</a> |</li>
        <li class="right" >
          <a href="persistence.html" title="Persistence"
             >previous</a> |</li>
        <li><a href="../../index.html">GPI Data Pipeline 1.3.0 documentation</a> &raquo;</li>
          <li><a href="../index.html" >GPI IFS Data Handbook</a> &raquo;</li>
          <li><a href="index.html" >Processing GPI Data, Step by Step</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2008-2014, Marshall Perrin, Jerome Maire &amp; the GPI Data Analysis Team.
      Last updated on Jun 18, 2015.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.2.2.
    </div>
  </body>
</html>